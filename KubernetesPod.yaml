apiVersion: v1
kind: Pod
metadata:
  name: jenkins-build
  namespace: qa-ingrastructure
spec:
  containers:
  - name: kaniko
    image: gcr.io/kaniko-project/executor:debug
    args: ["--dockerfile=api-demo/Dockerfile",
            "--context=.",
            "--insecure",
            "--skip-tls-verify",
            "--cache=true",
            "--destination=index.docker.io/sikor1111/dotnet-demo:beta"]
    volumeMounts:
      - name: jenkins-docker-cfg
        mountPath: /kaniko
  volumes:
  - name: jenkins-docker-cfg
    projected:
      sources:
      - secret:
        name: regcred
        items:
          - key: .dockerconfigjson
            path: .docker/config.json